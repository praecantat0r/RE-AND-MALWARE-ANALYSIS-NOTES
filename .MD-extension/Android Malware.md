# Android Malware
## Android Basics
- Only 4.9% of Android users are running the current version.
- Android system has more layers of abstraction that any desktop operating system.
- Malware can target any of these layers.
>
![[Pasted image 20210921202146.png]]

    Layers of the Android OS architecture:
    1. Application
    2. Application Framework
    3. Libraries
    4. Linux Kernel

## Mobile Malware
- Mobile malware introduces an array of new possibilities for malicious behavior, some of these include:
-                                    GPS 
-                                Accelerometer
-                               SMS,Camera,C&C

- It also has a few disadvantages and constraints:
-                       Limited Power, Bandwith, Permissions

## Infection Vectors
- Usually requires side-loading
- Generally social engineering attacks
- Vectors include:
-                                  Phishing
-                            Third Party app stores
-                                Exploit Kits
-                               Backdoored SDKs

## Profiting from Infection
- Exfiltration of data
- Botnet addition (like with Hide and Seek botnet)
- Stealing personal information
> ![[Pasted image 20210921201605.png]]

## SNIPPET
- This snippet is from a Malware which was posing as a System Update.
- Images and data courtesy of zimperium 
- It's a RAT that can execute commands to collect and exfiltrate data.
- Steps after Installation:
> 1. Registers the device with Firebase Command and Control with a few details
> > ![[Pasted image 20210921205027.png]]
> 
> 2. Spyware looks for any activity of interest, if it finds any it starts recording it. After that it collects the updated call log and the uploads the contents to the C&C server as an Encrypted ZIP file.
> > ![[Pasted image 20210921205056.png]]
> 3. When it receives a success response from the C&C server it deletes the files.
> 4. All collected data is organized into folders inside the spyware's private storage.
> > ![[Pasted image 20210921205007.png]]
> 5. The spyware compares information collected using the `Build.DEVICE` and `Build.MODEL` against a list of hardcoded values of Devices.
> > ![[Pasted image 20210921204948.png]]
> 6. The spyware creates a notification if the device’s screen is off when it receives a command using the Firebase messaging service. The “Searching for update..” is not a legitimate notification from the operating system, but the spyware.
> > ![[Pasted image 20210921204936.png]]

## Further Learning
- https://www.csee.umbc.edu/courses/undergraduate/CMSC491malware/android-malware.pdf
- https://www.tutorialspoint.com/mobile_security/index.htm



 