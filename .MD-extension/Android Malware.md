# Android Malware
## Android Basics
- Only 4.9% of Android users are running the current version.
- Android system has more layers of abstraction that any desktop operating system.
- Malware can target any of these layers.
>
![image](https://user-images.githubusercontent.com/86436966/134231407-afd9e4ce-1e60-430e-a3c2-c1df30c6a865.png)


    Layers of the Android OS architecture:
    1. Application
    2. Application Framework
    3. Libraries
    4. Linux Kernel

## Mobile Malware
- Mobile malware introduces an array of new possibilities for malicious behavior, some of these include:
-                                    GPS 
-                                Accelerometer
-                               SMS,Camera,C&C

- It also has a few disadvantages and constraints:
-                       Limited Power, Bandwith, Permissions

## Infection Vectors
- Usually requires side-loading
- Generally social engineering attacks
- Vectors include:
-                                  Phishing
-                            Third Party app stores
-                                Exploit Kits
-                               Backdoored SDKs

## Profiting from Infection
- Exfiltration of data
- Botnet addition (like with Hide and Seek botnet)
- Stealing personal information
> ![image](https://user-images.githubusercontent.com/86436966/134231465-080022a9-0b81-44d6-8457-27affd0d5889.png)

## SNIPPET
- This snippet is from a Malware which was posing as a System Update.
- Images and data courtesy of zimperium 
- It's a RAT that can execute commands to collect and exfiltrate data.
- Steps after Installation:
> 1. Registers the device with Firebase Command and Control with a few details
> > ![image](https://user-images.githubusercontent.com/86436966/134231505-49a40574-46f4-4de8-a990-cd2378b5f4ea.png)
> 
> 2. Spyware looks for any activity of interest, if it finds any it starts recording it. After that it collects the updated call log and the uploads the contents to the C&C server as an Encrypted ZIP file.
> > ![image](https://user-images.githubusercontent.com/86436966/134231588-0635c2fb-b8c1-4477-aed7-3004cb1ed116.png)
> 3. When it receives a success response from the C&C server it deletes the files.
> 4. All collected data is organized into folders inside the spyware's private storage.
> > ![image](https://user-images.githubusercontent.com/86436966/134231627-b503d7da-483f-4186-b508-362977aa37f4.png)
> 5. The spyware compares information collected using the `Build.DEVICE` and `Build.MODEL` against a list of hardcoded values of Devices.
> > ![image](https://user-images.githubusercontent.com/86436966/134231678-4c098a3e-f0f6-4cb0-82c4-a3621c705cdf.png)
> 6. The spyware creates a notification if the device’s screen is off when it receives a command using the Firebase messaging service. The “Searching for update..” is not a legitimate notification from the operating system, but the spyware.
> > ![image](https://user-images.githubusercontent.com/86436966/134231699-87a4d121-c313-47ec-ba3e-b802513b5f7a.png)

## Further Learning
- https://www.csee.umbc.edu/courses/undergraduate/CMSC491malware/android-malware.pdf
- https://www.tutorialspoint.com/mobile_security/index.htm



 
